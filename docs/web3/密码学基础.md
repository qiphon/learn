# 密码学基础

#### 为什么要学

- crypto

- 区块链底层安全机制的保障

- web3 安全的必备知识

#### 密码学概览

- 加密、解密
  - 对称加密 （加解密使用相同的密钥）
    - 特点：效率高，双方必须事先共享密钥
    - 凯撒密码 （对字母表中的字母进行移位作为密文）
    - 维吉尼亚密码
    - 分组密码 DES 、AES
    - 流密码
      - 伪随机数生成器（PRG）
  - 非对称加密
    - 特点：加解密密钥不同、效率低
    - 解决方式：通过非对称交换密钥，再用对称加密通信
    - 安全性来源
      - 基于数学难题
        - 破解密码的难度归约到决绝某个数学难题的难度
        - RSA：基于大整数分解的困难。 N = p \* q，已知 N，求 p 和 q 很困难
        - 离散对数： 方程 y = g^x mod p ，已知 y ,g, p，求 x 很困难
        - 椭圆曲线密码 ECC：基于椭圆曲线的离散对数
          - 并不是在每个群上的离散对数都是难解的
          - 在某个椭圆曲线上难解，一个群对应一组 abcde 参数
          - 比特币选取的曲线是 secp256k1
- 数字签名
- 哈希
- 其他： 密码分析

#### 克尔霍夫原则 Kerckhoffs's Principle

- 对于一个密码学系统，应当仅有密钥是保密的，其余算法和一切参数都应该是公开的。
- 并不一定要数学上的完全不可破解，只要在现实中不可能破解即可。

#### 理解数字签名

- 对称算法加解密

  - Alice 给Bob 发送消息，Alice 用 Bob 的公钥加密，Bob 解密消息用自己的私钥
  - 在没有私钥的情况下，无法获取明文相关信息

- 数字签名

  - Alice 想要证明某个消息是自己发的
  - Alice 用自己的私钥进行签名，然后其他人可以用公钥验证签名的有效性
  - 在没有私钥的情况下，无法伪造签名
  - ECDSA

### 哈希算法

消息摘要

    - 把无穷的消息映射到有效的空间内
    - H(M) = x
    - 确定性算法
    - 消息一但改变，消息摘要也会改变

重要性质：

    - 不可逆（单向性）
        - 拿到 哈希 的人，没有办法知道明文是什么
    - 抗碰撞
        - 无法找到 2 个不同的消息，但是获得同样的哈希值（计算意义上不可能）
    - 确定性
    - 混淆性
    - 不可预测性

### 区块链中的密码学

- 钱包地址

  - 每个地址实际上对应对公私钥对
  - 私钥 ---> 公钥 -----> 固定算法 ----> 地址
  - 私钥是证明你拥有该账户的唯一凭证，一旦泄露，别人将会用用

- 交易

  - 每个交易就是一个 message （用私钥签名）

- 靠哈希算法来出块

  - 此处只讨论 PoW 类
  - 暴力枚举计算哈希小于某个值
  - 由于哈希算法的好性质，没有除了暴力枚举之外的挖矿方法
  - 通过去中心的分散性保证去中心化出块

- 通过哈希算法维护最长链，防止攻击

  - 每个块的头部，都包含上一个哈希区块的哈希（链式结构）
  - 想要修改之前区块中的某个内容，需要从那个块开始整个后面的块都要改
  - 枚举哈希很难，所以很难对抗全网算力算出新的链

- Merkle Tree (默克尔树)
  - 一种靠哈希来快速确认某个值是否在一个集合中的数据结构
  - 常用于区块存储交易，发行白名单确认等场景
